<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Inventory Management System</title>
    <link rel="icon" href="../favicon.svg" type="image/svg+xml">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.4.0/exceljs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>
    <div class="container">
        <button type="button" id="toggleHeaderBtn" class="toggle-header-btn" title="Hide header">Hide header</button>
        <header id="headerSection">
            <div class="header-content">
                <div class="logo-wrapper">
                    <img src="../images/omsc.png" alt="OMSC Logo" class="header-logo">
                </div>
                <div class="header-text">
                    <h1>OCCIDENTAL MINDORO STATE COLLEGE</h1>
                    <h2>Multimedia and Speech Laboratory</h2>
                    <h3>ICT Equipment, Devices & Accessories</h3>
                    <p class="date-label">AS OF <span id="currentDate"></span></p>
                </div>
            </div>
        </header>

        <div class="controls" id="controlsSection">
            <div class="file-upload-section">
                <button id="addItemBtn" class="add-btn">‚ûï Add Item</button>
                <button id="addPCBtn" class="add-pc-btn">üñ•Ô∏è Add PC Section</button>
                <button id="newSheetBtn" class="new-sheet-btn">üìÑ New Sheet</button>
                <button id="importExcelBtn" class="import-excel-btn" type="button">üì§ Import Excel</button>
                <input type="file" id="importExcelInput" accept=".xlsx,.xls" style="display: none;">
                <button id="exportBtn" class="export-btn" disabled>üì• Export to Excel</button>
                <button id="restoreBackupBtn" class="restore-backup-btn" type="button" style="display: none;">üîÑ Restore</button>
                <button id="clearBtn" class="clear-btn" disabled>üóëÔ∏è Clear Data</button>
                <span id="saveStatus" class="save-status" aria-live="polite"></span>
            </div>
        </div>

        <!-- Sheet Tabs -->
        <div class="sheet-tabs-container">
            <div id="sheetTabs" class="sheet-tabs">
                <div class="sheet-tab active" data-sheet-id="sheet-1">
                    <span class="sheet-name">Sheet 1</span>
                    <span class="sheet-tab-menu" data-sheet-id="sheet-1" title="More">‚ãÆ</span>
                    <div class="sheet-tab-dropdown">
                        <button type="button" class="rename-option">Rename</button>
                        <button type="button" class="delete-option">Delete</button>
                    </div>
                    <span class="close-sheet" data-sheet-id="sheet-1">√ó</span>
                </div>
            </div>
        </div>

        <div class="table-container">
            <table id="inventoryTable">
                <thead>
                    <tr>
                        <th class="col-add" style="width:36px"></th>
                        <th>Article/It</th>
                        <th>Description</th>
                        <th>Old Property N Assigned</th>
                        <th>Unit of meas</th>
                        <th>Unit Value</th>
                        <th>Quantity per Physical count</th>
                        <th>Location/Whereabout</th>
                        <th>Condition</th>
                        <th>Remarks</th>
                        <th>User</th>
                        <th>Picture</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <tr class="empty-row">
                        <td colspan="13" class="empty-message">No data loaded. Please import an Excel file or add items manually.</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div class="inventory-summary-section">
            <h3 class="summary-title">Summary by Article/Item</h3>
            <table class="data-table summary-table" id="inventorySummaryTable">
                <thead>
                    <tr>
                        <th>Item Categories/Names</th>
                        <th>Unit Measure</th>
                        <th>Existing</th>
                        <th>2026</th>
                        <th>2027</th>
                        <th>2028</th>
                        <th>2029</th>
                        <th>For Disposal</th>
                        <th>Remarks</th>
                    </tr>
                </thead>
                <tbody id="inventorySummaryBody">
                    <tr><td colspan="9" class="summary-empty">No data ‚Äî add items or import Excel to see summary.</td></tr>
                </tbody>
            </table>
        </div>
        <div class="signatures-inventory">
            <div class="sig-row-inv">
                <label>Prepared by:</label>
                <input type="text" id="preparedBy" placeholder="Name, Role" value="JOVEN T. CRUZ, Laboratory Custodian">
            </div>
            <div class="sig-row-inv">
                <label>Noted by:</label>
                <input type="text" id="notedBy" placeholder="Name, Role" value="JOSELITO D. AGUID, PhDs, LPT, CHRA, Director for Instruction, CAST / Immediate Supervisor">
            </div>
        </div>
    </div>

    <!-- Add Item Modal -->
    <div id="addItemModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Add New Inventory Item</h2>
                <span class="close-modal">&times;</span>
            </div>
            <form id="addItemForm">
                <div class="form-grid">
                    <div class="form-group">
                        <label for="article">Article/It:</label>
                        <select id="article" name="article">
                            <option value="">Select Article/Item</option>
                        </select>
                        <input type="text" id="articleOther" name="articleOther" placeholder="Type if Other" class="form-field-blocked" style="display:none; margin-top:4px;">
                    </div>
                    <div class="form-group">
                        <label for="description">Description:</label>
                        <input type="text" id="description" name="description">
                    </div>
                    <div class="form-group">
                        <label for="oldProperty">Old Property N Assigned:</label>
                        <input type="text" id="oldProperty" name="oldProperty">
                    </div>
                    <div class="form-group">
                        <label for="unitOfMeas">Unit of meas:</label>
                        <input type="text" id="unitOfMeas" name="unitOfMeas" placeholder="e.g., pcs, unit" readonly class="form-field-blocked">
                    </div>
                    <div class="form-group">
                        <label for="unitValue">Unit Value:</label>
                        <input type="text" id="unitValue" name="unitValue" placeholder="e.g., P5,000.00" readonly class="form-field-blocked">
                    </div>
                    <div class="form-group">
                        <label for="quantity">Quantity per Physical count:</label>
                        <input type="number" id="quantity" name="quantity" value="1" min="1">
                    </div>
                    <div class="form-group">
                        <label for="location">Location/Whereabout:</label>
                        <select id="location" name="location">
                            <option value="MULTIMEDIA AND SPEECH LAB">MULTIMEDIA AND SPEECH LAB</option>
                            <option value="COMPUTER LABORATORY">COMPUTER LABORATORY</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="condition">Condition:</label>
                        <select id="condition" name="condition">
                            <option value="">Select Condition</option>
                            <option value="Serviceable">Serviceable</option>
                            <option value="Unserviceable">Unserviceable</option>
                            <option value="For Repair">For Repair</option>
                            <option value="Good">Good</option>
                            <option value="Fair">Fair</option>
                            <option value="Poor">Poor</option>
                            <option value="Borrowed">Borrowed</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="remarks">Remarks:</label>
                        <input type="text" id="remarks" name="remarks" placeholder="e.g., For Rep. 2026">
                    </div>
                    <div class="form-group">
                        <label for="user">User:</label>
                        <input type="text" id="user" name="user" placeholder="e.g., MR TO ANGELINA C. PAQUIBOT" readonly class="form-field-blocked">
                    </div>
                    <div class="form-group full-width">
                        <label for="picture">Picture:</label>
                        <input type="file" id="picture" name="picture" accept="image/*">
                        <div id="picturePreview" class="picture-preview empty">
                            <span>No image selected</span>
                        </div>
                        <small class="form-hint">Recommended: upload a picture for each item. Nagsesave rin ito sa row.</small>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="submit" class="submit-btn">Add Item</button>
                    <button type="button" class="cancel-btn" id="cancelAddBtn">Cancel</button>
                </div>
            </form>
        </div>
    </div>

    <script src="config.js"></script>
    <script src="script.js"></script>
</body>
</html>
